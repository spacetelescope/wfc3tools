<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>calwf3 &mdash; wfc3tools 1.1 documentation</title>
    
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="wfc3tools 1.1 documentation" href="index.html" />
    <link rel="next" title="wf32d" href="wf32d.html" />
    <link rel="prev" title="Welcome to the wfc3tools package documentation!" href="index.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="wf32d.html" title="wf32d"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to the wfc3tools package documentation!"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">wfc3tools 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="calwf3">
<h1>calwf3<a class="headerlink" href="#calwf3" title="Permalink to this headline">¶</a></h1>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>In Python without TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">calwf3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">calwf3</span><span class="o">.</span><span class="n">calwf3</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>In Python with TEAL:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">stsci.tools</span> <span class="kn">import</span> <span class="n">teal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">calwf3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">teal</span><span class="o">.</span><span class="n">teal</span><span class="p">(</span><span class="s">&#39;calwf3&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In Pyraf:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">wfc3tools</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">epar</span> <span class="n">calwf3</span>
</pre></div>
</div>
</div></blockquote>
<p>A detailed description of this new and improved <tt class="docutils literal"><span class="pre">calwf3</span></tt> will be available in a future publication of WFC3 Data Handbook.
The current WFC3 Data Handbook can be found at  <a class="reference external" href="http://www.stsci.edu/hst/wfc3/documents/handbooks/currentDHB/">http://www.stsci.edu/hst/wfc3/documents/handbooks/currentDHB/</a> .
In the meantime, if you have questions not answered in this documentation, please contact STScI Help Desk (help[at]stsci.edu).</p>
</div>
<div class="section" id="running-calwf3">
<h2>Running calwf3<a class="headerlink" href="#running-calwf3" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">calwf3</span></tt> can be run on a single input raw file or an asn table listing the members of an associtaion.
When processing an association, it retrieves calibration switch and reference file keyword settings from
the first image listed in the asn table. <tt class="docutils literal"><span class="pre">calwf3</span></tt> does not accept a user-defined list of input images on the
command line (e.g. <tt class="docutils literal"><span class="pre">*raw.fits</span></tt> to process all raw files in the current directory).</p>
<p>The <tt class="docutils literal"><span class="pre">wf3ccd</span></tt>, <tt class="docutils literal"><span class="pre">wf32d</span></tt>, and <tt class="docutils literal"><span class="pre">wf3ir</span></tt> tasks on the other hand, will accept such user-defined input file lists,
but they will not accept an association table( asn ) as input.</p>
</div>
<div class="section" id="batch-calwf3">
<h2>Batch calwf3<a class="headerlink" href="#batch-calwf3" title="Permalink to this headline">¶</a></h2>
<p>The recommended method for running <tt class="docutils literal"><span class="pre">calwf3</span></tt> in batch mode is to use Python and
the <tt class="docutils literal"><span class="pre">wfc3tools</span></tt> package in the &#8220;STSDAS distribution
&lt;<a class="reference external" href="http://www.stsci.edu/institute/software_hardware/stsdas/download-stsdas">http://www.stsci.edu/institute/software_hardware/stsdas/download-stsdas</a>&gt;.&#8221;</p>
<p>For example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">wfc3tools</span> <span class="kn">import</span> <span class="n">calwf3</span>
<span class="kn">import</span> <span class="nn">glob</span>

<span class="k">for</span> <span class="n">fits</span> <span class="ow">in</span> <span class="n">glob</span><span class="o">.</span><span class="n">glob</span><span class="p">(</span><span class="s">&#39;j*_raw.fits&#39;</span><span class="p">):</span>
    <span class="n">calwf3</span><span class="o">.</span><span class="n">calwf3</span><span class="p">(</span><span class="n">fits</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="where-to-find-calwf3">
<h2>Where to Find calwf3<a class="headerlink" href="#where-to-find-calwf3" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">calwf3</span></tt> is now part of HSTCAL package, which can be downloaded from
<a class="reference external" href="http://www.stsci.edu/institute/software_hardware/stsdas/download-stsdas">http://www.stsci.edu/institute/software_hardware/stsdas/download-stsdas</a></p>
</div>
<div class="section" id="usage">
<h2>Usage<a class="headerlink" href="#usage" title="Permalink to this headline">¶</a></h2>
<p><strong>The calwf3 executable can also be called directly from the command line:</strong></p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">calwf3</span><span class="o">.</span><span class="n">e</span> <span class="n">iaa001kaq_raw</span><span class="o">.</span><span class="n">fits</span> <span class="p">[</span><span class="n">command</span> <span class="n">line</span> <span class="n">options</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="command-line-options">
<h2>Command Line Options<a class="headerlink" href="#command-line-options" title="Permalink to this headline">¶</a></h2>
<p><tt class="docutils literal"><span class="pre">calwf3</span></tt> supports several command line options:</p>
<ul class="simple">
<li>-t: Print verbose time stamps.</li>
<li>-s: Save temporary files.</li>
<li>-v: Turn on verbose output.</li>
<li>-d: Turn on debug output.</li>
<li>-q: Turn on quiet output.</li>
<li>-r: Print the current software version number (revision)</li>
<li>&#8211;version: Print the current software version</li>
</ul>
</div>
<div class="section" id="cte-correction-pctecorr">
<h2>CTE correction (PCTECORR)<a class="headerlink" href="#cte-correction-pctecorr" title="Permalink to this headline">¶</a></h2>
<p>The charge transfer efficiency (CTE) of the UVIS detector has inevitably been declining over time as on-orbit radiation damage creates charge traps in the CCDs. Faint sources in particular can suffer large flux losses or even be lost entirely if observations are not planned and analyzed carefully. The CTE loss will depend on the morphology of the source, the distribution of electrons in the field of view (from sources, background, cosmic rays, and hot pixels) and the population of charge traps in the detector column between the source and the transfer register. And the magnitude of the CTE loss increases continuously with time as new charge traps form.</p>
<p>CTE is typically measured as a pixel-transfer efficiency, and would be unity for a perfect CCD. One indicator of CTE is the Extended Pixel Edge Response (EPER). Inefficient transfer of electrons in a flat-field exposure produces an exponential tail of charge in the overscan region. Analysis of monitoring observations through January 2013 shows that CTE continues to decline linearly over time (WFC3 ISR 2013-03). For further updates, see the CTE section of the WFC3 Performance Monitoring webpage.</p>
</div>
<div class="section" id="unit-conversion-to-electrons">
<h2>Unit Conversion to Electrons<a class="headerlink" href="#unit-conversion-to-electrons" title="Permalink to this headline">¶</a></h2>
<p>The UVIS image is multiplied by gain right after BIASCORR, converting it to
ELECTRONS. This step is no longer embedded within FLATCORR.</p>
</div>
<div class="section" id="dark-current-subtraction-darkcorr">
<h2>Dark Current Subtraction (DARKCORR)<a class="headerlink" href="#dark-current-subtraction-darkcorr" title="Permalink to this headline">¶</a></h2>
<p>It uses DARKFILE for the reference dark image.</p>
<p>The UVIS Dark image is now scaled by EXPTIME and FLASHDUR.</p>
</div>
<div class="section" id="post-flash-correction-flshcorr">
<h2>Post-Flash Correction (FLSHCORR)<a class="headerlink" href="#post-flash-correction-flshcorr" title="Permalink to this headline">¶</a></h2>
<p>Post-flash correction is now performed after DARKCORR in the WF32D step.
When FLSHCORR=PERFORM, it uses FLSHFILE (the post-flash reference file).</p>
</div>
<div class="section" id="flatcorr">
<h2>FLATCORR<a class="headerlink" href="#flatcorr" title="Permalink to this headline">¶</a></h2>
<p>Conversion from DN to ELECTRONS no longer depends on FLATCORR=PERFORM. Unit
conversion is done for all exposures after BIASCORR.</p>
</div>
<div class="section" id="photometry-keywords-photcorr">
<h2>Photometry Keywords (PHOTCORR)<a class="headerlink" href="#photometry-keywords-photcorr" title="Permalink to this headline">¶</a></h2>
<p>The PHOTCORR step is now performed using tables of precomputed values instead
of calls  to SYNPHOT. The correct table for a given image must be specified
in the IMPHTTAB header keyword in order for calwf3 to perform the PHOTCORR step.
By default, it should be in the <tt class="docutils literal"><span class="pre">iref</span></tt> directory and have the suffix
<tt class="docutils literal"><span class="pre">_imp.fits</span></tt>. Each DETECTOR uses a different table.</p>
<p>If you do not wish to use this feature, set PHOTCORR to OMIT.
If you intend to use FLUXCORR, then PHOTCORR must be set to PERFORM as well.</p>
</div>
<div class="section" id="flux-normalization-for-uvis1-and-uvis2-fluxcorr">
<h2>Flux normalization for UVIS1 and UVIS2 (FLUXCORR)<a class="headerlink" href="#flux-normalization-for-uvis1-and-uvis2-fluxcorr" title="Permalink to this headline">¶</a></h2>
<p>The FLUXCORR step was added in calwf3 v3.2.1 as a way to scale the UVIS chips
so that they will produce the same flux when converted to electrons. This requires new keywords
which specify new PHOTFLAM values to use for each chip as well as a keyword to specify the scaling factor
for the chips. New flatfields must be used and will replace the old flatfields in CDBS but the change will
not be noticable to users. Users should be aware that flatfield images used in conjunction with v3.2.1
of the software should not be used with older versions as the data will be scaled incorrectly.</p>
<p>The new keywords include:</p>
<p>PHTFLAM1: The FLAM for UVIS 1
PHTFLAM2: The FLAM for UVIS 2
PHTRATIO: The ratio: PHTFLAM2 / PHTFLAM1, which is calculated by calwf3 and is multiplied with UVIS2 (SCI,1 in the data file)</p>
<p>In order for FLUXCORR to work the value of PHOTCORR must also be set to perform since this populates
the header of the data with the keywords FLUXCORR requires to compute the PHTRATIO.</p>
</div>
<div class="section" id="calwf3-output">
<h2>calwf3 Output<a class="headerlink" href="#calwf3-output" title="Permalink to this headline">¶</a></h2>
<p>Using RAW as input:</p>
<blockquote>
<div><ul class="simple">
<li>flt.fits: output calibrated exposure.</li>
<li>ima.fits: output ramp calibration IR exposure.</li>
</ul>
</div></blockquote>
<p>Using ASN as input with WF3REJ:</p>
<blockquote>
<div><ul class="simple">
<li>crj.fits: cosmic ray rejected image</li>
</ul>
</div></blockquote>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="index.html">
              <img class="logo" src="_static/stsci_logo.png" alt="Logo"/>
            </a></p>
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">calwf3</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#running-calwf3">Running calwf3</a></li>
<li><a class="reference internal" href="#batch-calwf3">Batch calwf3</a></li>
<li><a class="reference internal" href="#where-to-find-calwf3">Where to Find calwf3</a></li>
<li><a class="reference internal" href="#usage">Usage</a></li>
<li><a class="reference internal" href="#command-line-options">Command Line Options</a></li>
<li><a class="reference internal" href="#cte-correction-pctecorr">CTE correction (PCTECORR)</a></li>
<li><a class="reference internal" href="#unit-conversion-to-electrons">Unit Conversion to Electrons</a></li>
<li><a class="reference internal" href="#dark-current-subtraction-darkcorr">Dark Current Subtraction (DARKCORR)</a></li>
<li><a class="reference internal" href="#post-flash-correction-flshcorr">Post-Flash Correction (FLSHCORR)</a></li>
<li><a class="reference internal" href="#flatcorr">FLATCORR</a></li>
<li><a class="reference internal" href="#photometry-keywords-photcorr">Photometry Keywords (PHOTCORR)</a></li>
<li><a class="reference internal" href="#flux-normalization-for-uvis1-and-uvis2-fluxcorr">Flux normalization for UVIS1 and UVIS2 (FLUXCORR)</a></li>
<li><a class="reference internal" href="#calwf3-output">calwf3 Output</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to the wfc3tools package documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="wf32d.html"
                        title="next chapter">wf32d</a></p>
  <h3>This Page</h3>
  <ul class="this-page-menu">
    <li><a href="_sources/calwf3.txt"
           rel="nofollow">Show Source</a></li>
  </ul>
<div id="searchbox" style="display: none">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="wf32d.html" title="wf32d"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to the wfc3tools package documentation!"
             >previous</a> |</li>
        <li><a href="index.html">wfc3tools 1.1 documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
        &copy; Copyright 2012, Megan Sosey, Howard Bushouse, Warren Hack.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.2.2.
    </div>
  </body>
</html>